---
import '../../styles/global.css';
import BaseLayout from '../../layouts/BaseLayout.astro';
import Header from '../../components/layout/Header.astro';
import Footer from '../../components/layout/Footer.astro';
import { getCollection, render } from 'astro:content';

export async function getStaticPaths() {
  const posts = await getCollection('blog');
  return posts.map((post) => ({
    params: { slug: post.id },
    props: post,
  }));
}

const post = Astro.props;
const { Content } = await render(post);
---

<BaseLayout title={`${post.data.title} - GridSwitch Blog`} description={post.data.description}>
  <Header />
  <main class="pt-32 pb-24">
    <article class="max-w-3xl mx-auto px-6">
      <div class="mb-10">
        <a href="/blog" class="text-sm text-accent hover:underline mb-4 inline-block">&larr; Back to blog</a>
        <h1 class="text-3xl md:text-5xl font-bold mb-4">{post.data.title}</h1>
        <time class="text-sm text-text-secondary">
          {post.data.pubDate.toLocaleDateString('en-US', {
            year: 'numeric',
            month: 'long',
            day: 'numeric',
          })}
        </time>
      </div>

      <div class="prose prose-invert prose-lg max-w-none
        [&_h2]:text-2xl [&_h2]:font-bold [&_h2]:mt-10 [&_h2]:mb-4 [&_h2]:text-text-primary
        [&_h3]:text-xl [&_h3]:font-semibold [&_h3]:mt-8 [&_h3]:mb-3 [&_h3]:text-text-primary
        [&_p]:text-text-secondary [&_p]:leading-relaxed [&_p]:mb-4
        [&_a]:text-accent [&_a]:underline
        [&_ul]:list-disc [&_ul]:pl-6 [&_ul]:text-text-secondary
        [&_ol]:list-decimal [&_ol]:pl-6 [&_ol]:text-text-secondary
        [&_li]:mb-2
        [&_code]:bg-bg-card [&_code]:px-2 [&_code]:py-0.5 [&_code]:rounded [&_code]:text-sm
        [&_pre]:bg-bg-card [&_pre]:p-4 [&_pre]:rounded-xl [&_pre]:overflow-x-auto
        [&_blockquote]:border-l-4 [&_blockquote]:border-accent [&_blockquote]:pl-4 [&_blockquote]:italic
        [&_img]:rounded-xl [&_img]:mx-auto
      ">
        <Content />
      </div>
    </article>
  </main>
  <Footer />
</BaseLayout>
